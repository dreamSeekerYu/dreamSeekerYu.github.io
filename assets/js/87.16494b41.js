(window.webpackJsonp=window.webpackJsonp||[]).push([[87],{446:function(s,n,a){"use strict";a.r(n);var e=a(46),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"axios-二次封装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#axios-二次封装"}},[s._v("#")]),s._v(" axios 二次封装")]),s._v(" "),a("h4",{attrs:{id:"一次基础封装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一次基础封装"}},[s._v("#")]),s._v(" 一次基础封装")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("配置拦截器 \n全局数据处理  \n状态处理 \n全局提示\n个性化方法  导入导出...\n错误重试  retry\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h4",{attrs:{id:"二次封装-请求自动绑定"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二次封装-请求自动绑定"}},[s._v("#")]),s._v(" 二次封装 请求自动绑定")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("api 更加抽象化\n请求自动绑定\n节流防抖  同一 api 依次单线执行\n\nimport { request，autoBind } from '@/utils/request'\n\n// function autoBind(obj = {}) {\n//   // autoBind 公用函数  和 request 放在一起  import 导入\n//   const service = {}\n//   Object.keys(obj).forEach(objKey => {\n//     service[objKey] = function (data) {\n//       return request({ ...obj[objKey], data })\n//     }\n//   })\n//   return service\n// }\n\n\n// 当前文件的配置\nexport const testConfig = {\n  queryPage: { url: '/tspeapi/usm/app/ApiAppInfo' },// 假设 请求默认都是 post 的形式\n  insertApp: { url: '/tspeapi/usm/app/insertAppDTO' },\n  updateApp: { url: '/tspeapi/usm/app/updateAppDTO' },\n  getAppById: { url: '/tspeapi/usm/app/getAppById' },\n  queryBusinessLineList: { url: '/tspeapi/usm/app/queryBusinessLineList', method: 'get' }\n}\n\nexport const testService = autoBind(testConfig)\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])]),a("p",[s._v("请求封装完成之后,  使用效果不是特别明显，建议只做 API 统一挂载在 server 函数上面即可\n这个对整体的项目的影响不太大")]),s._v(" "),a("h5",{attrs:{id:"导出文件-下载文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#导出文件-下载文件"}},[s._v("#")]),s._v(" 导出文件 下载文件")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("export function getExport(url, param, fileName) {\n  return axios.request({\n    url: url,\n    data: param,\n    responseType: 'arraybuffer', // 代表内存之中的一段二进制数据 必须加\n    method: 'post'\n  }).then(res => {\n    // const filename =  fileName;\n    fileDownload(res.data, fileName)\n    try {\n      const blob = new Blob([res.data])\n      const reader = new FileReader()\n      reader.readAsText(blob, 'utf-8')\n      reader.onload = function(e) {\n        const data = JSON.parse(JSON.stringify(reader.result))\n        if (data.status !== 0) {\n          // Message({\n          //   showClose: true,\n          //   message: data.msg\n          // })\n        }\n      }\n    } catch (e) {\n      console.log(e)\n    }\n  }\n  )\n}\nexport function getExportBypeData(url, param) {\n  return axios.request({\n    url: url,\n    data: param,\n    method: 'post'\n  }).then(({ data }) => {\n    const { fileData, fileName } = data.data\n    fileDownload(new Uint8Array(fileData), fileName)\n  })\n}\nexport function fileDownload(data, fileName) {\n  const blob = new Blob([data], {\n    type: 'application/octet-stream'\n  })\n  if (fileName !== '模板下载.xlsx') {\n    fileName = fileName\n  }\n  if (typeof window.navigator.msSaveBlob !== 'undefined') {\n    window.navigator.msSaveBlob(blob, fileName)\n  } else {\n    var blobURL = window.URL.createObjectURL(blob)\n    var tempLink = document.createElement('a')\n    tempLink.style.display = 'none'\n    tempLink.href = blobURL\n    tempLink.setAttribute('download', fileName)\n    if (typeof tempLink.download === 'undefined') {\n      tempLink.setAttribute('target', '_blank')\n    }\n    document.body.appendChild(tempLink)\n    tempLink.click()\n    document.body.removeChild(tempLink)\n    window.URL.revokeObjectURL(blobURL)\n  }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br")])])])}),[],!1,null,null,null);n.default=t.exports}}]);